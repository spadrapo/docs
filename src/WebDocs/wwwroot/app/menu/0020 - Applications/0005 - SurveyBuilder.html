<!DOCTYPE html>
<script src="/drapo.js"></script>
<style>
.survey-app {
    max-width: 900px;
    margin: 0 auto;
    padding: 20px;
    font-family: Arial, sans-serif;
}

.builder-section {
    background: #f8f9fa;
    padding: 25px;
    border-radius: 10px;
    margin-bottom: 30px;
    border: 1px solid #e9ecef;
}

.form-section {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.builder-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.builder-header h3 {
    margin: 0;
    color: #333;
}

.question-controls {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

.btn {
    background: #3498db;
    color: white;
    padding: 10px 15px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.2s;
}

.btn:hover {
    background: #2980b9;
}

.btn-success {
    background: #27ae60;
}

.btn-success:hover {
    background: #229954;
}

.btn-danger {
    background: #e74c3c;
}

.btn-danger:hover {
    background: #c0392b;
}

.btn-secondary {
    background: #95a5a6;
}

.btn-secondary:hover {
    background: #7f8c8d;
}

.question-item {
    background: white;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 15px;
    position: relative;
}

.question-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 15px;
}

.question-type-badge {
    background: #3498db;
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: bold;
    text-transform: uppercase;
}

.question-actions {
    display: flex;
    gap: 5px;
}

.btn-small {
    padding: 5px 10px;
    font-size: 12px;
}

.form-group {
    margin-bottom: 15px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    color: #333;
}

.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    box-sizing: border-box;
}

.form-group textarea {
    resize: vertical;
    min-height: 80px;
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
    border-color: #3498db;
    outline: none;
}

.options-list {
    margin-top: 10px;
}

.option-item {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
    align-items: center;
}

.option-input {
    flex-grow: 1;
}

.form-preview {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    margin-top: 20px;
}

.preview-question {
    margin-bottom: 20px;
}

.preview-question h4 {
    margin: 0 0 10px 0;
    color: #333;
}

.preview-question .required-mark {
    color: #e74c3c;
}

.radio-group,
.checkbox-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.radio-item,
.checkbox-item {
    display: flex;
    align-items: center;
    gap: 8px;
}

.results-section {
    background: #e8f5e8;
    padding: 20px;
    border-radius: 8px;
    margin-top: 20px;
    border: 1px solid #c3e6c3;
}

.results-section h4 {
    margin: 0 0 15px 0;
    color: #27ae60;
}

.answer-item {
    margin-bottom: 10px;
    padding: 10px;
    background: white;
    border-radius: 4px;
    border-left: 4px solid #27ae60;
}

.answer-label {
    font-weight: bold;
    color: #333;
}

.answer-value {
    color: #666;
    margin-top: 5px;
}
</style>
<div>
    <div>
        <h2>Survey Builder</h2>
        <p>A dynamic form builder application demonstrating complex validation, conditional logic, and dynamic content generation with Drapo.</p>
        <br />
        <d-sample>
            <div d-dataKey="survey" d-dataType="object" 
                 d-dataProperty-title="Customer Feedback Survey"
                 d-dataProperty-description="Help us improve our services by sharing your feedback"></div>
            <div d-dataKey="questions" d-dataType="array"></div>
            <div d-dataKey="responses" d-dataType="object"></div>
            <div d-dataKey="newQuestion" d-dataType="object"></div>
            <div d-dataKey="showPreview" d-dataType="object" d-dataProperty-value="false"></div>
            <div d-dataKey="showResults" d-dataType="object" d-dataProperty-value="false"></div>
            
            <div class="survey-app">
                <!-- Survey Builder Section -->
                <div class="builder-section">
                    <div class="builder-header">
                        <h3>üîß Survey Builder</h3>
                        <div class="question-controls">
                            <button class="btn" d-on-click="ToggleData(showPreview,value)">
                                Show/Hide Preview
                            </button>
                            <button class="btn btn-success" d-on-click="ToggleData(showResults,value)">
                                Show/Hide Results
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Survey Title</label>
                        <input type="text" d-model="{{survey.title}}" placeholder="Enter survey title">
                    </div>

                    <div class="form-group">
                        <label>Survey Description</label>
                        <textarea d-model="{{survey.description}}" placeholder="Enter survey description"></textarea>
                    </div>

                    <h4>Add New Question</h4>
                    <div class="form-group">
                        <label>Question Text</label>
                        <input type="text" d-model="{{newQuestion.text}}" placeholder="Enter your question">
                    </div>

                    <div class="form-group">
                        <label>Question Type</label>
                        <select d-model="{{newQuestion.type}}">
                            <option value="">Select question type</option>
                            <option value="text">Text Input</option>
                            <option value="textarea">Long Text</option>
                            <option value="radio">Multiple Choice (Single)</option>
                            <option value="checkbox">Multiple Choice (Multiple)</option>
                            <option value="rating">Rating Scale</option>
                        </select>
                    </div>

                    <div d-if="{{newQuestion.type}}=='radio'||{{newQuestion.type}}=='checkbox'" class="form-group">
                        <label>Options (one per line)</label>
                        <textarea d-model="{{newQuestion.options}}" placeholder="Option 1&#10;Option 2&#10;Option 3"></textarea>
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" d-model="{{newQuestion.required}}"> Required question
                        </label>
                    </div>

                    <button class="btn btn-success" d-on-click="AddDataItem(questions,newQuestion,false);ClearDataField(newQuestion,text);ClearDataField(newQuestion,type);ClearDataField(newQuestion,options);UncheckDataField(newQuestion,required)">
                        ‚ûï Add Question
                    </button>
                </div>

                <!-- Questions List -->
                <div class="builder-section">
                    <h4>Survey Questions</h4>
                    <div d-for="question in questions" class="question-item">
                        <div class="question-header">
                            <span class="question-type-badge">{{question.type}}</span>
                            <div class="question-actions">
                                <button class="btn btn-danger btn-small" d-on-click="RemoveDataItem(questions,question)">
                                    üóëÔ∏è Delete
                                </button>
                            </div>
                        </div>
                        <h5>{{question.text}}</h5>
                        <div d-if="{{question.options}}">
                            <strong>Options:</strong> {{question.options}}
                        </div>
                    </div>
                </div>

                <!-- Survey Preview -->
                <div d-if="{{showPreview.value}}" class="form-section">
                    <h3>üìã {{survey.title}}</h3>
                    <p>{{survey.description}}</p>
                    <div class="form-preview">
                        <div d-for="question in questions" class="preview-question">
                            <h4>{{question.text}}</h4>
                            <div d-if="{{question.type}}=='text'">
                                <input type="text" placeholder="Your answer...">
                            </div>
                            <div d-if="{{question.type}}=='textarea'">
                                <textarea placeholder="Your detailed answer..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Survey Results -->
                <div d-if="{{showResults.value}}" class="results-section">
                    <h4>üìä Survey Results</h4>
                    <div d-for="question in questions" class="answer-item">
                        <div class="answer-label">{{question.text}}</div>
                        <div class="answer-value">
                            <strong>Answer:</strong> Sample answer
                        </div>
                    </div>
                </div>
            </div>
            
        </d-sample>
        <br />
        <br />
        <br />
        <br />
    </div>
</div>