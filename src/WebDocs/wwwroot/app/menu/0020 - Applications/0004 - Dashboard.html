<!DOCTYPE html>
<script src="/drapo.js"></script>
<style>
.dashboard-app {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    font-family: Arial, sans-serif;
    background: #f8f9fa;
}

.dashboard-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    border-radius: 10px;
    margin-bottom: 30px;
    text-align: center;
}

.dashboard-header h1 {
    margin: 0 0 10px 0;
    font-size: 28px;
}

.dashboard-header p {
    margin: 0;
    opacity: 0.9;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    text-align: center;
    transition: transform 0.2s;
}

.stat-card:hover {
    transform: translateY(-2px);
}

.stat-icon {
    font-size: 40px;
    margin-bottom: 15px;
}

.stat-value {
    font-size: 32px;
    font-weight: bold;
    color: #333;
    margin-bottom: 5px;
}

.stat-label {
    color: #666;
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.stat-change {
    font-size: 12px;
    margin-top: 5px;
}

.stat-change.positive {
    color: #27ae60;
}

.stat-change.negative {
    color: #e74c3c;
}

.charts-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 30px;
}

.chart-card {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.chart-title {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 20px;
    color: #333;
}

.chart-container {
    height: 200px;
    background: #f8f9fa;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    color: #666;
}

.progress-bar {
    width: 100%;
    height: 20px;
    background: #e9ecef;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #667eea, #764ba2);
    transition: width 0.3s ease;
    border-radius: 10px;
}

.data-table {
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    overflow: hidden;
}

.table-header {
    background: #667eea;
    color: white;
    padding: 20px;
    font-size: 18px;
    font-weight: bold;
}

.table-content {
    padding: 0;
}

.table-row {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr;
    padding: 15px 20px;
    border-bottom: 1px solid #e9ecef;
    align-items: center;
}

.table-row:nth-child(even) {
    background: #f8f9fa;
}

.table-row:last-child {
    border-bottom: none;
}

.table-cell {
    font-size: 14px;
}

.table-cell.header {
    font-weight: bold;
    color: #333;
    background: #f1f3f5;
}

.status-badge {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: bold;
    text-transform: uppercase;
}

.status-active {
    background: #d4edda;
    color: #155724;
}

.status-pending {
    background: #fff3cd;
    color: #856404;
}

.status-inactive {
    background: #f8d7da;
    color: #721c24;
}

.controls-section {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
    align-items: center;
}

.btn {
    background: #667eea;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.2s;
}

.btn:hover {
    background: #5a6fd8;
}

.btn-secondary {
    background: #6c757d;
}

.btn-secondary:hover {
    background: #5a6268;
}

@media (max-width: 768px) {
    .charts-section {
        grid-template-columns: 1fr;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .table-row {
        grid-template-columns: 1fr;
        gap: 5px;
    }
}
</style>
<div>
    <div>
        <h2>Dashboard Analytics</h2>
        <p>A comprehensive analytics dashboard demonstrating data visualization, real-time updates, and responsive design with Drapo.</p>
        <br />
        <d-sample>
            <div d-dataKey="stats" d-dataType="object" 
                 d-dataProperty-totalUsers="1247"
                 d-dataProperty-revenue="34567.89"
                 d-dataProperty-orders="89"
                 d-dataProperty-conversion="3.2"></div>
            
            <div d-dataKey="projects" d-dataType="array"
                 d-dataProperty-0="{Name:'Website Redesign',Progress:85,Status:'active',Budget:15000}"
                 d-dataProperty-1="{Name:'Mobile App',Progress:42,Status:'active',Budget:25000}"
                 d-dataProperty-2="{Name:'API Development',Progress:67,Status:'pending',Budget:12000}"
                 d-dataProperty-3="{Name:'Database Migration',Progress:100,Status:'inactive',Budget:8000}"
                 d-dataProperty-4="{Name:'Security Audit',Progress:23,Status:'pending',Budget:5000}"></div>
                 
            <div d-dataKey="refreshCount" d-dataType="object" d-dataProperty-value="0"></div>
            
            <div class="dashboard-app">
                <div class="dashboard-header">
                    <h1>Analytics Dashboard</h1>
                    <p>Real-time business metrics and project tracking</p>
                </div>
                
                <div class="controls-section">
                    <button class="btn" d-on-click="RefreshDashboard(stats,refreshCount)">ðŸ”„ Refresh Data</button>
                    <button class="btn btn-secondary" d-on-click="ExportData(projects)">ðŸ“Š Export Report</button>
                    <span style="margin-left: auto; color: #666;">Last updated: {{GetCurrentDateTime()}}</span>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">ðŸ‘¥</div>
                        <div class="stat-value">{{FormatNumber({{stats.totalUsers}},0)}}</div>
                        <div class="stat-label">Total Users</div>
                        <div class="stat-change positive">â†— +12% from last month</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">ðŸ’°</div>
                        <div class="stat-value">${{FormatCurrency({{stats.revenue}},0)}}</div>
                        <div class="stat-label">Revenue</div>
                        <div class="stat-change positive">â†— +8.3% from last month</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">ðŸ“¦</div>
                        <div class="stat-value">{{stats.orders}}</div>
                        <div class="stat-label">Orders Today</div>
                        <div class="stat-change negative">â†˜ -2.1% from yesterday</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">ðŸ“ˆ</div>
                        <div class="stat-value">{{stats.conversion}}%</div>
                        <div class="stat-label">Conversion Rate</div>
                        <div class="stat-change positive">â†— +0.4% from last week</div>
                    </div>
                </div>

                <div class="charts-section">
                    <div class="chart-card">
                        <div class="chart-title">Sales Trend</div>
                        <div class="chart-container">
                            ðŸ“Š Interactive sales chart would render here<br>
                            <small>Current revenue: ${{FormatCurrency({{stats.revenue}},2)}}</small>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <div class="chart-title">User Growth</div>
                        <div class="chart-container">
                            ðŸ“ˆ User growth visualization<br>
                            <small>Total users: {{FormatNumber({{stats.totalUsers}},0)}}</small>
                        </div>
                    </div>
                </div>

                <div class="data-table">
                    <div class="table-header">
                        Project Status Overview
                    </div>
                    <div class="table-content">
                        <div class="table-row">
                            <div class="table-cell header">Project Name</div>
                            <div class="table-cell header">Progress</div>
                            <div class="table-cell header">Status</div>
                            <div class="table-cell header">Budget</div>
                        </div>
                        
                        <div d-for="project in projects" class="table-row">
                            <div class="table-cell">{{project.Name}}</div>
                            <div class="table-cell">
                                <div class="progress-bar">
                                    <div class="progress-fill" d-style="width:{{project.Progress}}%"></div>
                                </div>
                                {{project.Progress}}%
                            </div>
                            <div class="table-cell">
                                <span d-class="status-badge,status-{{project.Status}}">{{project.Status}}</span>
                            </div>
                            <div class="table-cell">${{FormatCurrency({{project.Budget}},0)}}</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <script>
                window.RefreshDashboard = function(stats, refreshCount) {
                    // Simulate data refresh with random variations
                    stats.totalUsers = Math.floor(stats.totalUsers + (Math.random() - 0.5) * 100);
                    stats.revenue = stats.revenue + (Math.random() - 0.5) * 5000;
                    stats.orders = Math.floor(stats.orders + (Math.random() - 0.5) * 20);
                    stats.conversion = Math.round((stats.conversion + (Math.random() - 0.5) * 2) * 10) / 10;
                    
                    refreshCount.value += 1;
                    alert('Dashboard data refreshed! (Refresh #' + refreshCount.value + ')');
                };
                
                window.ExportData = function(projects) {
                    var csvContent = "Project Name,Progress,Status,Budget\n";
                    projects.forEach(function(project) {
                        csvContent += project.Name + "," + project.Progress + "%," + project.Status + ",$" + project.Budget + "\n";
                    });
                    
                    // In a real application, this would trigger a file download
                    alert("Export data (CSV format):\n\n" + csvContent);
                };
                
                window.GetCurrentDateTime = function() {
                    return new Date().toLocaleString();
                };
            </script>
        </d-sample>
        <br />
        <br />
        <br />
        <br />
    </div>
</div>